<p id="notice"><%= notice %></p>

<b><font size="6">æå‡ºç‰©ä¸€è¦§</font></b>
<% if @user_code && @user_code.first == "t" %>
  <div style = "text-align: right;float;right">
    <span>
      <%= link_to 'ç™»éŒ²', new_submission_path, class: "btn-sub" %>
    </span>
  </div>
<% end %>

<%= form_tag('/submissions_search') do %>
  <p>
    <font size="4">
     ç§‘ç›®
    </font>
   <%= text_field_tag 'search[subject]', session[:search_subject] %>
    <font size="4">
      æœŸé™
    </font>
    <%= select_tag 'search[deadline]', options_for_select({æœŸé™å‰: "æœŸé™å‰", æœŸé™åˆ‡ã‚Œ: "æœŸé™åˆ‡ã‚Œ"},
    { :selected => session[:search_deadline]}), include_blank: true %>
  </p>

  <p>
    <font size="4">
      ã‚¿ã‚¤ãƒˆãƒ«
    </font>
    <%= text_field_tag 'search[title]', session[:search_title] %>
    <%= submit_tag 'æ¤œç´¢ğŸ”' %>
  </p> 

<% end %>

<%= form_tag('/submissions_select_edit') do %>
  <% if @user_code && @user_code.first == "t" %>
   <p>
     <%= submit_tag "é¸æŠç·¨é›†", onclick: "return isCheck()"  %>
       &thinsp;
     <%= submit_tag "é¸æŠå‰Šé™¤", onclick: "return isCheck()"  %>
   </p>

   <table border = "1" width = "100%">
      <thead>

        <tr>
          <th><label for="all"><input type="checkbox" class="allChecked" id="all"></label></th>
          <th><font size="4">ç§‘ç›®</font></th>
          <th><font size="4">ã‚¿ã‚¤ãƒˆãƒ«</font></th>
          <th><font size="4">å¯¾è±¡</font></th>
          <th><font size="4">æœŸé™</font></th>
          <th colspan="1"></th>
          <th colspan="1"></th>
          <th colspan="1"></th>
        </tr>
      </thead>

     <tbody>
        <% @submissions.each do |submission| %>
          <tr>
            <td align="center">
              <%= check_box_tag "select_datas[#{ submission.id }]", submission.id,false,:class => "list" %>
            </td>
            <td align="center"><%= submission.subject %></td>
            <td align="center"><%= submission.title %></td>
            <td align="center"><%= submission.grade %>-<%= submission.class_room %></td>
            <td align="center"><%= submission.deadline %></td>

            <td align="center"><%= link_to 'è©³ç´°', submission %></td>
            <td align="center"><%= link_to 'ç·¨é›†', edit_submission_path(submission) %></td>
            <td align="center"><%= link_to 'å‰Šé™¤', submission, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        <% end %>
     </tbody>
   </table>

  <% else %>
   <table border = "1" width = "100%">
      <thead>
        <tr>
          <th><font size="4">ç§‘ç›®</font></th>
          <th><font size="4">ã‚¿ã‚¤ãƒˆãƒ«</font></th>
          <th><font size="4">æœŸé™</font></th>
          <th colspan="1"></th>
        </tr>
      </thead>

     <tbody>
       <% @submissions.each do |submission| %>
         <tr>
           <td align="center"><%= submission.subject %></td>
           <td align="center"><%= submission.title %></td>
           <td align="center"><%= submission.deadline %></td>
           <td align="center"><%= link_to 'è©³ç´°', submission %></td>
         </tr>
       <% end %>
     </tbody>
   </table>
  <% end %>

<% end %>

<script type="text/javascript">
$(function() {
  return $(document).on("click", ".allChecked", function() {
    if ($(this).prop('checked')) {
      $(".list").prop('checked', true);
      return $(this).prop('checked', true);
    } else {
      $(".list").prop('checked', false);
    }
  });
});

function isCheck() {
  var arr_checkBoxes = document.getElementsByClassName("list");
  var count = 0;
  for (var i = 0; i <arr_checkBoxes.length; i++) {
    if (arr_checkBoxes[i].checked) {
      count++;
    }
  }
  if (count > 0) {
    return true;
  } else {
    window.alert("é …ç›®ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚");
    return false;
  }
}
</script>